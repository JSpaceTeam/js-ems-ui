#!/usr/bin/expect

if { [llength $argv] < 4 } {
    puts "Usage: $argv0 IP USER PASSWORD COMMAND"
    exit 1
}
set IP [lindex $argv 0]
set USR [lindex $argv 1]
set PASS [lindex $argv 2]
set CMD [lindex $argv 3]

puts "$argv0 $IP $USR $PASS $CMD"

set timeout 60
spawn ssh $USR@$IP "$CMD"
expect "*yes/no*" { send "yes\r" }
expect "*password:*" { send "$PASS\r"}

expect eof
